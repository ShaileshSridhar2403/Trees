{"ast":null,"code":"import _slicedToArray from\"/home/shailesh/Projects/Trees/Trees/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _classCallCheck from\"/home/shailesh/Projects/Trees/Trees/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/shailesh/Projects/Trees/Trees/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/shailesh/Projects/Trees/Trees/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/shailesh/Projects/Trees/Trees/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import axios from\"axios\";import GraphUI from\"./GraphUI\";import React from\"react\";var AllNotes=/*#__PURE__*/function(_React$Component){_inherits(AllNotes,_React$Component);var _super=_createSuper(AllNotes);function AllNotes(){var _this;_classCallCheck(this,AllNotes);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={allNotes:[],links:{},treeData:{},titleMap:{}};return _this;}_createClass(AllNotes,[{key:\"saveLinks\",value:function saveLinks(){var _this2=this;axios.post(\"/api/links\",{links:JSON.stringify(this.state.links)}).then(function(res){console.log(\"saving\",res.data);console.log(\"tree data\",JSON.stringify(_this2.state.treeData));});}},{key:\"updateTitleMap\",value:function updateTitleMap(){var titleMap={};this.state.allNotes.forEach(function(note){titleMap[note._id]=note.title;});this.setState({titleMap:titleMap});}// driver function\n},{key:\"populateTreeData\",value:function populateTreeData(){if(Object.keys(this.state.links).length==0)return;var treeData=this.recurseTreeData(this.state.links,Object.keys(this.state.links)[0]);this.setState({treeData:treeData});}// recursion\n},{key:\"recurseTreeData\",value:function recurseTreeData(links,id){var _this3=this;if(links[id].length==0){return{\"name\":this.state.titleMap[id],\"id\":id,\"size\":[150,150],\"children\":[]};}var treeData={\"name\":this.state.titleMap[id],\"id\":id,\"size\":[150,150],\"children\":[]};links[id].forEach(function(childId){treeData.children.push(_this3.recurseTreeData(links,childId));});return treeData;}},{key:\"init\",value:function init(){var _this4=this;// there should not be a case when allNotes length is 0 and links is not 0\nif(this.state.allNotes.length==0){console.log(\"initializing...\");axios.post(\"/api/notes\",{title:\"Master\",content:\"-\"}).then(function(){axios.get(\"/api/notes\").then(function(res){var notes=res.data;var rootLink=res.data[0]._id;_this4.setState({allNotes:notes});var links=_this4.state.links;links[rootLink]=[];_this4.setState({links:links});}).then(function(){_this4.updateTitleMap();_this4.populateTreeData();});});}else{axios.get(\"/api/links\").then(function(res){var links=JSON.parse(res.data[0].links);_this4.setState({links:links});}).then(function(){_this4.updateTitleMap();_this4.populateTreeData();});}}},{key:\"componentDidMount\",value:function componentDidMount(){var _this5=this;axios.get(\"/api/notes\").then(function(res){console.log(\"HEYYY\");var notes=res.data;_this5.setState({allNotes:notes});_this5.updateTitleMap();}).then(function(){_this5.init();});}},{key:\"deleteLinks\",value:function deleteLinks(id){var _this6=this;if(this.state.links[id]===undefined){return;}if(this.state.links[id].length==0){delete this.state.links[id];}else{this.state.links[id].forEach(function(element){_this6.deleteLinks(element);});delete this.state.links[id];}this.setState({links:this.state.links});}},{key:\"deleteNote\",value:function deleteNote(_ref){var _this7=this;var variables=_ref.variables;axios.delete(\"/api/notes\"+variables._id).then(function(){axios.get(\"/api/notes\").then(function(res){var notes=res.data;_this7.setState({allNotes:notes});for(var _i=0,_Object$entries=Object.entries(_this7.state.links);_i<_Object$entries.length;_i++){var _Object$entries$_i=_slicedToArray(_Object$entries[_i],2),key=_Object$entries$_i[0],value=_Object$entries$_i[1];if(_this7.state.links[key].includes(variables._id)){var index=_this7.state.links[key].indexOf(variables._id);if(index>-1){_this7.state.links[key].splice(index,1);break;}}}}).then(function(){_this7.deleteLinks(variables._id);_this7.saveLinks();}).then(function(){if(_this7.state.AllNotes===undefined)_this7.init();}).then(function(){_this7.updateTitleMap();_this7.populateTreeData();_this7.props.history.push(\"/\");});}).catch(function(err){console.log(err);});}},{key:\"addChild\",value:function addChild(_ref2){var _this8=this;var variables=_ref2.variables;axios.get(\"/api/notes/addChild/\"+variables._id).then(function(res){var newChild=res.data;_this8.setState({allNotes:_this8.state.allNotes.concat([newChild])});_this8.state.links[variables._id].push(newChild._id);_this8.state.links[newChild._id]=[];_this8.setState({links:_this8.state.links});}).then(function(){_this8.updateTitleMap();_this8.populateTreeData();_this8.props.history.push(\"/\");}).then(function(){_this8.saveLinks();}).catch(function(err){console.log(err);});}},{key:\"addSibling\",value:function addSibling(_ref3){var _this9=this;var variables=_ref3.variables;axios.get(\"/api/notes/addSibling/\"+variables._id).then(function(res){var newSibling=res.data;_this9.setState({allNotes:_this9.state.allNotes.concat([newSibling])});for(var _i2=0,_Object$entries2=Object.entries(_this9.state.links);_i2<_Object$entries2.length;_i2++){var _Object$entries2$_i=_slicedToArray(_Object$entries2[_i2],2),key=_Object$entries2$_i[0],value=_Object$entries2$_i[1];if(_this9.state.links[key].includes(variables._id)){_this9.state.links[key].push(newSibling._id);_this9.state.links[newSibling._id]=[];break;}}}).then(function(){_this9.saveLinks();}).then(function(){_this9.updateTitleMap();_this9.populateTreeData();_this9.props.history.push(\"/\");}).catch(function(err){console.log(err);});}},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"div\",{className:\"App\"},/*#__PURE__*/React.createElement(\"header\",{className:\"App-header\"},/*#__PURE__*/React.createElement(GraphUI,{parentContext:this})));}}]);return AllNotes;}(React.Component);export default AllNotes;","map":{"version":3,"sources":["/home/shailesh/Projects/Trees/Trees/client/src/AllNotes.js"],"names":["axios","GraphUI","React","AllNotes","state","allNotes","links","treeData","titleMap","post","JSON","stringify","then","res","console","log","data","forEach","note","_id","title","setState","Object","keys","length","recurseTreeData","id","childId","children","push","content","get","notes","rootLink","updateTitleMap","populateTreeData","parse","init","undefined","element","deleteLinks","variables","delete","entries","key","value","includes","index","indexOf","splice","saveLinks","props","history","catch","err","newChild","concat","newSibling","Component"],"mappings":"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","sourcesContent":["import axios from \"axios\";\nimport GraphUI from \"./GraphUI\"\nimport React from \"react\";\n\n\nclass AllNotes extends React.Component {\n  state = {\n    allNotes: [],\n    links: {},\n    treeData: {},\n    titleMap:{}\n  };\n\n  saveLinks(){\n    axios\n    .post(\"/api/links\", {links: JSON.stringify(this.state.links)})\n    .then(res => {\n    console.log(\"saving\", res.data)\n    console.log(\"tree data\", JSON.stringify(this.state.treeData))\n    })\n  }\n\n  updateTitleMap(){\n    var titleMap = {}\n    this.state.allNotes.forEach(note => {\n      titleMap[note._id] = note.title\n    })\n    this.setState({titleMap:titleMap})\n  }\n  // driver function\n  populateTreeData() {\n    if (Object.keys(this.state.links).length == 0)return\n    var treeData = this.recurseTreeData(this.state.links, Object.keys(this.state.links)[0])\n    this.setState({ \n      treeData: treeData,\n    });\n  }\n\n  // recursion\n  recurseTreeData(links, id) {\n    if (links[id].length == 0) {\n      return {\n        \"name\": this.state.titleMap[id],\n        \"id\": id,\n        \"size\": [150, 150],\n        \"children\": []\n      }\n    }\n\n    var treeData = {\n      \"name\": this.state.titleMap[id],\n      \"id\": id,\n      \"size\": [150, 150],\n      \"children\": []\n    }\n    links[id].forEach(childId => {\n      treeData.children.push(this.recurseTreeData(links, childId))\n    });\n    return treeData\n  }\n\n  init() {\n    // there should not be a case when allNotes length is 0 and links is not 0\n    if (this.state.allNotes.length == 0) {\n      console.log(\"initializing...\")\n      axios\n      .post(\"/api/notes\", {title: \"Master\", content: \"-\"})\n      .then(() => {\n        axios\n        .get(\"/api/notes\")\n        .then(res => {\n          const notes = res.data;\n          var rootLink = res.data[0]._id\n          this.setState({ \n            allNotes: notes\n          });\n          var links = this.state.links\n          links[rootLink] = []\n          this.setState({links:links})\n        })\n        .then(() => {\n          this.updateTitleMap()\n          this.populateTreeData()\n        })\n      })\n    }\n    else {\n      axios\n      .get(\"/api/links\")\n      .then(res => {\n        const links = JSON.parse(res.data[0].links)\n        this.setState({ \n          links: links,\n        });\n      })\n      .then(() => {\n        this.updateTitleMap()\n        this.populateTreeData()\n      })\n    }\n  }\n\n  componentDidMount() {\n    axios\n    .get(\"/api/notes\")\n    .then(res => {\n      console.log(\"HEYYY\")\n      const notes = res.data;\n      this.setState({ \n        allNotes: notes,\n      });\n      this.updateTitleMap()\n    })\n    .then(() => {\n      this.init()\n    })\n  }\n\n  deleteLinks(id){\n    if (this.state.links[id] === undefined) {\n      return\n    }\n    if (this.state.links[id].length == 0) {\n      delete this.state.links[id]\n    }\n    else {\n      this.state.links[id].forEach(element => {\n        this.deleteLinks(element)\n      });\n      delete this.state.links[id]\n    }\n    this.setState({links:this.state.links})\n  }\n\n  deleteNote({variables}) {\n    axios\n    .delete(\"/api/notes\" + variables._id)\n    .then(() => {\n      axios\n      .get(\"/api/notes\")\n      .then(res => {\n        const notes = res.data;\n        this.setState({ \n          allNotes: notes\n        });\n        for (const [key, value] of Object.entries(this.state.links)) {\n          if (this.state.links[key].includes(variables._id)) {\n            const index = this.state.links[key].indexOf(variables._id)\n            if (index > -1) {\n              this.state.links[key].splice(index, 1)\n              break\n            }\n          }\n        }\n      })\n      .then(() => {\n        this.deleteLinks(variables._id)\n        this.saveLinks()\n      })\n      .then(() => {\n        if(this.state.AllNotes === undefined)this.init()\n      })\n      .then(() =>{\n        this.updateTitleMap()\n        this.populateTreeData()\n        this.props.history.push(\"/\")\n      })\n    })\n    .catch(err => {\n      console.log(err);\n    });\n  }\n\n  addChild({variables}) {\n    axios\n    .get(\"/api/notes/addChild/\" + variables._id)\n    .then(res => {\n      const newChild = res.data;\n      this.setState({ \n        allNotes: this.state.allNotes.concat([newChild])\n      });\n      this.state.links[variables._id].push(newChild._id)\n      this.state.links[newChild._id] = []\n      this.setState({links:this.state.links})\n    })\n    .then(() => {\n      this.updateTitleMap()\n      this.populateTreeData()\n      this.props.history.push(\"/\");\n      \n    })\n    .then(() => {\n      this.saveLinks()\n    })\n    .catch(err => {\n      console.log(err);\n    });\n  }\n\n  addSibling({variables}) {\n    axios\n    .get(\"/api/notes/addSibling/\" + variables._id)\n    .then(res => {\n      const newSibling = res.data;\n      this.setState({ \n        allNotes: this.state.allNotes.concat([newSibling])\n      });\n      for (const [key, value] of Object.entries(this.state.links)) {\n        if (this.state.links[key].includes(variables._id)) {\n          this.state.links[key].push(newSibling._id)\n          this.state.links[newSibling._id] = []\n          break\n        }\n      }\n    })\n    .then(() => {\n      this.saveLinks()\n    })\n    .then(() => {\n      this.updateTitleMap()\n      this.populateTreeData()\n      this.props.history.push(\"/\");\n    })\n    .catch(err => {\n      console.log(err);\n    });\n  }\n\n  render() {\n    return (\n      <div className=\"App\">\n        <header className=\"App-header\">\n          <GraphUI parentContext={this} />\n        </header>\n      </div>\n    );\n  };\n}\n\nexport default AllNotes;"]},"metadata":{},"sourceType":"module"}